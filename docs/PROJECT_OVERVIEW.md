# プロジェクト概要

## 📌 プロジェクト名

**Clash Royale Analytics Platform (クラロワ解析プラットフォーム)**

## 🎯 目的

Clash Royaleのプレイ動画をアップロードし、GoogleのAI技術で動画を解析することで、エリクサー管理、デッキコスト、攻撃タイミング、リスク分析などの詳細なレポートを生成し、プレイヤーのスキル向上を支援する。

## 👥 ターゲットユーザー

- Clash Royaleの競技プレイヤー
- 自分のプレイスタイルを詳しく分析したいプレイヤー
- エリクサー管理やタイミングを改善したいプレイヤー
- リスク管理を向上させたいプレイヤー
- 多言語対応により、日本、アメリカ、ヨーロッパなど世界中のプレイヤー

## 🎨 主要機能

### 1. 動画アップロード機能

**目的**: Clash Royaleのプレイ動画をアップロードし、解析の準備を行う

**機能詳細**:
- 動画ファイルのアップロード(MP4, MOV, AVI等)
- 動画のプレビュー表示
- アップロード進捗の表示
- 動画メタデータの保存(ファイル名、サイズ、アップロード日時)
- 動画の一覧表示・管理

**対応動画形式**:
- MP4 (推奨)
- MOV
- AVI
- WebM

**画面**:
- 動画アップロード画面
- 動画一覧画面
- 動画詳細画面

### 2. AI動画解析機能(メイン機能)

**目的**: GoogleのAI技術を使用して動画を解析し、プレイの詳細な情報を抽出する

**機能詳細**:

#### 2.1 動画解析処理
- Google Video Intelligence API / Gemini APIを使用した動画解析
- フレーム単位での情報抽出
- ゲーム画面の認識(カード、エリクサー、タイマー等)
- OCRによる数値情報の抽出

#### 2.2 解析項目
- **エリクサー管理分析**
  - エリクサーの使用タイミング
  - エリクサーの無駄遣い箇所
  - エリクサー効率の評価
  - オーバーロード(10エリクサー)状態の頻度とタイミング

- **コスト・デッキ分析**
  - デッキの平均コスト
  - カード使用の順序と頻度
  - 高コストカードと低コストカードのバランス
  - デッキコストに応じたプレイスタイルの評価

- **攻撃タイミング分析**
  - 攻撃を仕掛けたタイミング(何分何秒)
  - 攻撃タイミングの妥当性評価
  - 相手のエリクサー状況との関係
  - 攻撃タイミングによる結果(成功/失敗)

- **リスク分析**
  - 特定のプレイ(例: 〇分〇秒でのカード使用)に伴うリスク
  - エリクサー不足時の行動パターン
  - 防御が手薄になった瞬間の検出
  - リスクの高いプレイの洗い出し
  - リスクプレイによるダメージの影響度

- **時系列プレイ分析**
  - 時間軸に沿ったプレイの流れ
  - 各タイミングでの状況説明
  - 「〇分〇秒でこういうプレイをしたら、こういうリスクがある」形式の指摘

**Google AI API 使用**:
- Video Intelligence API: 動画の内容認識
- Gemini API: 動画の詳細分析とテキスト生成

### 3. レポート生成・表示機能

**目的**: 解析結果をデータベースに保存し、視覚的に表示する

**機能詳細**:

#### 3.1 レポート生成
- 解析完了後の自動レポート生成
- エリクサー、コスト、タイミング、リスクの総合レポート
- タイムライン形式でのプレイ説明
- リスク分析の詳細レポート

#### 3.2 データ保存
- 動画ファイルの保存
- 解析結果の保存
- タイムライン情報の保存
- リスク分析結果の保存

#### 3.3 レポート表示
- ダッシュボード(サマリー表示)
- 動画再生と解析結果の同期表示
- タイムライン表示
- グラフ・チャート表示
  - エリクサー使用推移グラフ
  - カード使用タイミングチャート
  - リスクスコアの可視化
- リスク分析のハイライト表示
- 「〇分でこういうプレイをした場合のリスク」一覧

**表示技術**:
- Video.js / Plyr (動画プレーヤー)
- Chart.js / ApexCharts (グラフ・チャート)
- Bootstrap / Tailwind CSS (UI)

## 🌐 多言語化要件

### 対応言語(優先順)
1. 日本語(ja)
2. 英語(en)
3. スペイン語(es) - 将来的
4. ドイツ語(de) - 将来的
5. フランス語(fr) - 将来的

### 多言語化対象
- UIテキスト(ボタン、ラベル、メッセージ)
- エラーメッセージ
- レポート内の説明文
- メールテンプレート

### 実装方法
- Laravelの多言語化機能(`resources/lang/`)
- フロントエンドも同様に対応
- ユーザー設定で言語切り替え可能
- ブラウザ言語の自動検出

## 🔐 セキュリティ要件

- Google AI APIキーの安全な管理
- 動画ファイルのアップロード検証(ファイル形式、サイズ制限)
- レート制限(API呼び出し頻度)
- CSRF保護
- XSS対策
- SQL injection対策(Eloquent ORM使用)
- 動画ファイルの保存先セキュリティ(アクセス制御)

## 📊 パフォーマンス要件

- APIレスポンス時間: 2秒以内
- ダッシュボード読み込み: 3秒以内
- 同時接続ユーザー数: 100人以上(目標)
- データキャッシュの活用

## 🚀 将来的な拡張機能(Phase 2)

- クラン全体の分析
- プレイヤー同士の比較機能
- AIによる戦略提案
- リアルタイム通知
- ソーシャル機能(コメント、シェア)
- モバイルアプリ

## 📈 成功指標(KPI)

- 登録ユーザー数
- 1日あたりのアクティブユーザー数
- レポート生成回数
- ユーザー継続率

## 🗓 開発スケジュール(想定)

### Phase 1: MVP開発(2-3ヶ月)
- Week 1-2: 環境構築、DB設計
- Week 3-4: ユーザー設定機能
- Week 5-8: 試合データ解析機能(基本)
- Week 9-10: レポート表示機能
- Week 11-12: 多言語化、テスト、デプロイ

### Phase 2: 機能拡張(3-6ヶ月後)
- 詳細分析機能の追加
- UI/UXの改善
- パフォーマンス最適化

## 📊 システム図・フロー図

システムの詳細なフローやアーキテクチャを理解するには、[DIAGRAMS.md](./DIAGRAMS.md)を参照してください（同じdocsディレクトリ内）。

以下の図が含まれています:
- システムアーキテクチャ図
- 動画アップロードフロー（シーケンス図）
- 動画解析フロー（シーケンス図）
- レポート生成・表示フロー（シーケンス図）
- データベースER図（詳細版）
- データフロー図
- コンポーネント構成図
- 認証・認可フロー
- エリクサー分析プロセス詳細
- リスク分析プロセス詳細
- システム全体フロー（統合図）

## 📚 参考リソース

- Google Video Intelligence API Documentation: https://cloud.google.com/video-intelligence/docs
- Google Gemini API Documentation: https://ai.google.dev/docs
- Laravel Documentation: https://laravel.com/docs
- Clash Royale ゲーム情報: https://clashroyale.com/

---

**最終更新**: 2026-01-06
